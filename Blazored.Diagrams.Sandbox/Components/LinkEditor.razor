@if (SelectedItem is not null)
{
    <MudCard>
        <MudCardHeader>

            <MudText>Edit Link</MudText>
        </MudCardHeader>
        <MudCardContent>
            <MudSelect T="Type" Value="@(typeof(CurvedLink))" ValueChanged="ctx => OnSelectChanged(SelectedItem, ctx)">
                <MudSelectItem T="Type" Value="@(typeof(LineLink))">Line</MudSelectItem>
                <MudSelectItem T="Type" Value="@(typeof(CurvedLink))">Curve</MudSelectItem>
                <MudSelectItem T="Type" Value="@(typeof(OrthogonalLink))">Orthogonal</MudSelectItem>
            </MudSelect>
        </MudCardContent>

    </MudCard>
}

@code {

    [CascadingParameter] public IDiagramService Service { get; set; }

    [Parameter] public ILink? SelectedItem { get; set; }


    private void Select(ILink link)
    {
        link.IsSelected = true;
    }

    private void OnSelectChanged(ILink link, Type ctx)
    {
        ILink newL;
        
        if (ctx == typeof(CurvedLink))
        {
            newL = new CurvedLink();
        }
        else  if (ctx == typeof(LineLink))
        {
            newL = new LineLink();
        }
        else if (ctx == typeof(OrthogonalLink))
        {
            newL = new OrthogonalLink();
        }
        else
        {
            throw new NotImplementedException();
        }
        
        Service.Add.AddLinkTo(link.SourcePort, link.TargetPort, newL);
        Service.Remove.Link(link);

    }

}